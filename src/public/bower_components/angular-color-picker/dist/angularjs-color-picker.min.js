/*!
 * angularjs-color-picker v1.0.1
 * https://github.com/ruhley/angular-color-picker/
 *
 * Copyright 2016 ruhley
 *
 * 2016-02-11 09:43:17
 *
 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="color.picker"),function(){"use strict";angular.module("color.picker",[])}(),function(){"use strict";var a=function(a){return{restrict:"E",require:["^ngModel"],scope:{ngModel:"=",colorPickerAlpha:"=",colorPickerCase:"=",colorPickerFormat:"=",colorPickerPos:"=",colorPickerSwatch:"=",colorPickerSwatchOnly:"=",colorPickerSwatchPos:"=",colorPickerSwatchBootstrap:"=",colorPickerOnChange:"&"},templateUrl:"template/color-picker/directive.html",link:function(b,c,d,e){b.onChangeValue=null,b.init=function(){
// if no color provided
if(void 0===b.ngModel)b.hue=0,b.saturation=0,b.lightness=100;else{var c=tinycolor(b.ngModel);if(c.isValid()){var d=c.toHsv();b.hue=d.h,b.saturation=100*d.s,b.lightness=100*d.v,b.opacity=100*d.a}}
// set default config settings
b.initConfig(),
// setup mouse events
a.on("mousedown",b.onMouseDown),a.on("mouseup",b.onMouseUp),a.on("mousemove",b.onMouseMove),b.find(".color-picker-grid").on("click",b.onColorClick),b.find(".color-picker-hue").on("click",b.onHueClick),b.find(".color-picker-opacity").on("click",b.onOpacityClick)},b.onMouseDown=function(a){
// an element in this picker
b.find(a.target).length>0&&(
// mouse event on color grid
a.target.classList.contains("color-picker-grid-inner")||a.target.classList.contains("color-picker-picker")||a.target.parentNode.classList.contains("color-picker-picker")?(b.colorDown(a),b.$apply()):a.target.classList.contains("color-picker-hue")||a.target.parentNode.classList.contains("color-picker-hue")?(b.hueDown(a),b.$apply()):(a.target.classList.contains("color-picker-opacity")||a.target.parentNode.classList.contains("color-picker-opacity"))&&(b.opacityDown(a),b.$apply()))},b.onMouseUp=function(a){
// no current mouse events and not an element in the picker
b.colorMouse||b.hueMouse||b.opacityMouse||0!==b.find(a.target).length?b.colorMouse?(b.colorUp(a),b.$apply(),b.onChange(a)):b.hueMouse?(b.hueUp(a),b.$apply(),b.onChange(a)):b.opacityMouse&&(b.opacityUp(a),b.$apply(),b.onChange(a)):(b.log("Color Picker: Document Click Event"),b.hide())},b.onMouseMove=function(a){
// mouse event on color grid
b.colorMouse?(b.colorChange(a),b.$apply()):b.hueMouse?(b.hueChange(a),b.$apply()):b.opacityMouse&&(b.opacityChange(a),b.$apply())},b.onColorClick=function(a){b.colorChange(a),b.$apply(),b.onChange(a)},b.onHueClick=function(a){b.hueChange(a),b.$apply(),b.onChange(a)},b.onOpacityClick=function(a){b.opacityChange(a),b.$apply(),b.onChange(a)},b.onChange=function(a){b.ngModel!==b.onChangeValue&&(b.onChangeValue=b.ngModel,b.colorPickerOnChange({$event:a,color:b.ngModel}))},b.initConfig=function(){b.config={},b.config.alpha=void 0===b.colorPickerAlpha?!0:b.colorPickerAlpha,b.config.case=void 0===b.colorPickerCase?"upper":b.colorPickerCase,b.config.format=void 0===b.colorPickerFormat?"hsl":b.colorPickerFormat,b.config.pos=void 0===b.colorPickerPos?"bottom left":b.colorPickerPos,b.config.swatch=void 0===b.colorPickerSwatch?!0:b.colorPickerSwatch,b.config.swatchOnly=void 0===b.colorPickerSwatchOnly?!1:b.colorPickerSwatchOnly,b.config.swatchPos=void 0===b.colorPickerSwatchPos?"left":b.colorPickerSwatchPos,b.config.swatchBootstrap=void 0===b.colorPickerSwatchBootstrap?!0:b.colorPickerSwatchBootstrap,b.log("Color Picker: Config",b.config)},b.focus=function(){b.log("Color Picker: Focus Event"),b.find(".color-picker-input")[0].focus()},b.show=function(){b.log("Color Picker: Show Event"),b.visible=!0,b.hueMouse=!1,b.opacityMouse=!1,b.colorMouse=!1,
// force the grid selection circle to redraw and fix its position
b.saturationUpdate(),b.lightnessUpdate()},b.hide=function(){(b.visible||null!==c[0].querySelector(".color-picker-panel").offsetParent)&&(b.log("Color Picker: Hide Event"),b.visible=!1,b.$apply())},b.update=function(){if(void 0!==b.hue&&void 0!==b.saturation&&void 0!==b.lightness){var a,c=tinycolor({h:b.hue,s:b.saturation/100,v:b.lightness/100});switch(b.config.alpha&&c.setAlpha(b.opacity/100),b.log("Color Picker: COLOR CHANGED TO ",c,b.hue,b.saturation,b.lightness,b.opacity),b.swatchColor=c.toHslString(),b.config.format){case"rgb":a=c.toRgbString();break;case"hex":a=c.toHexString(),a="lower"===b.config.case?a.toLowerCase():a.toUpperCase();break;case"hex8":a=c.toHex8String(),a="lower"===b.config.case?a.toLowerCase():a.toUpperCase();break;case"hsv":a=c.toHsvString();break;default:a=c.toHslString()}b.ngModel=a}},b.$watch("ngModel",function(a,c){if(void 0!==a&&null!==a&&a!==c&&a.length>4){b.log("Color Picker: MODEL - CHANGED",a);var f=tinycolor(a);if(f.isValid()){var g=f.toHsv();b.hue=g.h,b.saturation=100*g.s,b.lightness=100*g.v,b.config.alpha&&(b.opacity=100*g.a),b.isValid=!0}else b.isValid=!1;e[0].$setValidity(d.name,b.isValid),void 0!==c&&"function"==typeof e[0].$setDirty&&e[0].$setDirty()}else b.swatchColor=""}),b.$watch("colorPickerFormat",function(a,c){void 0!==a&&a!==c&&("hex"===a&&(b.colorPickerAlpha=!1),b.initConfig(),b.update())}),b.$watchGroup(["colorPickerAlpha","colorPickerCase"],function(a,c){void 0!==a&&(b.initConfig(),b.update())}),b.$watchGroup(["colorPickerSwatchPos","colorPickerSwatchBootstrap","colorPickerSwatchOnly","colorPickerSwatch","colorPickerPos"],function(a,c){void 0!==a&&b.initConfig()}),
//---------------------------
// Update Positions And Colors On Elements
//---------------------------
b.$watch("swatchColor",function(a){var b=angular.element(c[0].querySelector(".color-picker-swatch"));b.css({"background-color":a})}),b.$watch("huePos",function(a){var b=angular.element(c[0].querySelector(".color-picker-hue .color-picker-slider"));b.css({top:a+"%"})}),b.$watch("opacityPos",function(a){var b=angular.element(c[0].querySelector(".color-picker-opacity .color-picker-slider"));b.css({top:a+"%"})}),b.$watch("lightnessPos",function(a){var b=angular.element(c[0].querySelector(".color-picker-grid .color-picker-picker"));b.css({top:a+"%"})}),b.$watch("saturationPos",function(a){var b=angular.element(c[0].querySelector(".color-picker-grid .color-picker-picker"));b.css({left:a+"%"})}),b.$watch("grid",function(a){var b=angular.element(c[0].querySelector(".color-picker-grid"));b.css({"background-color":a})}),
//---------------------------
// HUE
//---------------------------
b.hueDown=function(a){a.stopPropagation(),a.preventDefault(),b.log("Color Picker: HUE - MOUSE DOWN"),b.hueMouse=!0},b.hueUp=function(a){a.stopPropagation(),a.preventDefault(),b.log("Color Picker: HUE - MOUSE UP"),b.hueMouse=!1},b.hueChange=function(a){a.stopPropagation(),a.preventDefault(),b.log("Color Picker: HUE - MOUSE CHANGE");var c=b.find(".color-picker-hue");b.hue=360*(1-(a.pageY-b.offset(c).top)/c.prop("offsetHeight")),b.hue>360?b.hue=360:b.hue<0&&(b.hue=0)},b.hueUpdate=function(){void 0!==b.hue&&(b.log("Color Picker: HUE - CHANGED"),b.huePos=100*(1-b.hue/360),b.grid=tinycolor({h:b.hue,s:100,v:1}).toHslString(),b.huePos<0?b.huePos=0:b.huePos>100&&(b.huePos=100),b.update())},b.$watch("hue",function(a,c){b.hueUpdate()}),
//---------------------------
// OPACITY
//---------------------------
b.opacityDown=function(a){a.stopPropagation(),a.preventDefault(),b.log("Color Picker: OPACITY - MOUSE DOWN"),b.opacityMouse=!0},b.opacityUp=function(a){a.stopPropagation(),a.preventDefault(),b.log("Color Picker: OPACITY - MOUSE UP"),b.opacityMouse=!1},b.opacityChange=function(a){a.stopPropagation(),a.preventDefault(),b.log("Color Picker: OPACITY - MOUSE CHANGE");var c=b.find(".color-picker-opacity");b.opacity=100*(1-(a.pageY-b.offset(c).top)/c.prop("offsetHeight")),b.opacity>100?b.opacity=100:b.opacity<0&&(b.opacity=0)},b.opacityUpdate=function(){void 0!==b.opacity&&(b.log("Color Picker: OPACITY - CHANGED"),b.opacityPos=100*(1-b.opacity/100),b.opacityPos<0?b.opacityPos=0:b.opacityPos>100&&(b.opacityPos=100),b.update())},b.$watch("opacity",function(a,c){b.opacityUpdate()}),
//---------------------------
// COLOR
//---------------------------
b.colorDown=function(a){a.stopPropagation(),a.preventDefault(),b.log("Color Picker: COLOR - MOUSE DOWN"),b.colorMouse=!0},b.colorUp=function(a){a.stopPropagation(),a.preventDefault(),b.log("Color Picker: COLOR - MOUSE UP"),b.colorMouse=!1},b.colorChange=function(a){a.stopPropagation(),a.preventDefault(),b.log("Color Picker: COLOR - MOUSE CHANGE");var c=b.find(".color-picker-grid-inner"),d=b.offset(c);b.saturation=(a.pageX-d.left)/c.prop("offsetWidth")*100,b.lightness=100*(1-(a.pageY-d.top)/c.prop("offsetHeight")),b.saturation>100?b.saturation=100:b.saturation<0&&(b.saturation=0),b.lightness>100?b.lightness=100:b.lightness<0&&(b.lightness=0)},b.saturationUpdate=function(a){void 0!==b.saturation&&b.saturation!==a&&(b.log("Color Picker: SATURATION - CHANGED"),b.saturationPos=b.saturation/100*100,b.saturationPos<0?b.saturationPos=0:b.saturationPos>100&&(b.saturationPos=100),b.update())},b.$watch("saturation",function(a,c){b.saturationUpdate(c)}),b.lightnessUpdate=function(a){void 0!==b.lightness&&b.lightness!==a&&(b.log("Color Picker: LIGHTNESS - CHANGED"),b.lightnessPos=100*(1-b.lightness/100),b.lightnessPos<0?b.lightnessPos=0:b.lightnessPos>100&&(b.lightnessPos=100),b.update())},b.$watch("lightness",function(a,c){b.lightnessUpdate(c)}),
//---------------------------
// HELPER FUNCTIONS
//---------------------------
b.log=function(){},
// taken and modified from jQuery's find
b.find=function(a){var d,e=b.wrapper?b.wrapper[0]:c[0],f=[];
// Same basic safeguard as Sizzle
if(!a)return f;if("string"==typeof a){
// Early return if context is not an element or document
if(1!==(d=e.nodeType)&&9!==d)return[];f=e.querySelectorAll(a)}else e.contains(a)&&f.push(a);return angular.element(f)},
// taken and modified from jQuery's offset
b.offset=function(a){var b,c,d,e,f=a[0];if(f)
// Support: IE<=11+
// Running getBoundingClientRect on a
// disconnected node in IE throws an error
// Support: IE<=11+
// Running getBoundingClientRect on a
// disconnected node in IE throws an error
// Make sure element is not hidden (display: none)
// hack for small chrome screens not position the clicks properly when the page is scrolled
return f.getClientRects().length?(d=f.getBoundingClientRect(),d.width||d.height?(e=f.ownerDocument,c=null!==e&&e===e.window?e:9===e.nodeType&&e.defaultView,b=e.documentElement,window.chrome&&screen.width<=768?{top:d.top-b.clientTop,left:d.left-b.clientLeft}:{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}):d):{top:0,left:0}},b.init(),b.$on("$destroy",function(){a.off("mousedown",b.onMouseDown),a.off("mouseup",b.onMouseUp),a.off("mousemove",b.onMouseMove)})}}};a.$inject=["$document"],angular.module("color.picker").directive("colorPicker",a)}(),angular.module("color.picker").run(["$templateCache",function(a){a.put("template/color-picker/directive.html",'<div class="color-picker-wrapper" ng-class="{\'color-picker-swatch-only\': config.swatchOnly}">\n   <div class="color-picker-input-wrapper" ng-class="{\'input-group\': config.swatchBootstrap && config.swatch}">\n       <span ng-if="config.swatchPos === \'left\'" class="color-picker-swatch" ng-click="focus()" ng-show="config.swatch" ng-class="{\'color-picker-swatch-left\': config.swatchPos !== \'right\', \'color-picker-swatch-right\': config.swatchPos === \'right\', \'input-group-addon\': config.swatchBootstrap}"></span>\n       <input class="color-picker-input form-control" type="text" ng-model="ngModel" ng-change="onChange($event)" size="7" ng-focus="show()" ng-class="{\'color-picker-input-swatch\': config.swatch && !config.swatchOnly && config.swatchPos === \'left\'}">\n       <span ng-if="config.swatchPos === \'right\'" class="color-picker-swatch" ng-click="focus()" ng-show="config.swatch" ng-class="{\'color-picker-swatch-left\': config.swatchPos !== \'right\', \'color-picker-swatch-right\': config.swatchPos === \'right\', \'input-group-addon\': config.swatchBootstrap}"></span>\n   </div>\n   <div class="color-picker-panel" ng-show="visible" ng-class="{\n       \'color-picker-panel-top color-picker-panel-right\': config.pos === \'top right\',\n       \'color-picker-panel-top color-picker-panel-left\': config.pos === \'top left\',\n       \'color-picker-panel-bottom color-picker-panel-right\': config.pos === \'bottom right\',\n       \'color-picker-panel-bottom color-picker-panel-left\': config.pos === \'bottom left\',\n   }">\n       <div class="color-picker-hue color-picker-sprite">\n           <div class="color-picker-slider"></div>\n       </div>\n       <div class="color-picker-opacity color-picker-sprite" ng-show="config.alpha">\n           <div class="color-picker-slider"></div>\n           </div>\n       <div class="color-picker-grid color-picker-sprite">\n           <div class="color-picker-grid-inner"></div>\n           <div class="color-picker-picker">\n               <div></div>\n           </div>\n       </div>\n   </div>\n</div>')}]);